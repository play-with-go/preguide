# Test that we get the expected output when using -raw

# A run should generate stdout but no out/gen_out.cue file
preguide gen -raw -out _output
cmp stdout raw/stdout
! stderr .+
! exists raw/out/gen_out.cue

-- raw/en.markdown --
---
title: A test with raw output
---

<!--step: step1 -->
-- raw/steps.cue --
package steps

import "github.com/play-with-go/preguide"

// We embed preguide.#Guide here as a check that doing so
// means we can correctly validate, decode etc the package
// (because if you try to extract position information from
// the cue.Value that is the package in this case it will
// fail, because of the unification with preguide.#Guide)
preguide.#Guide

Image: "this_will_never_be_used"

Steps: step1: en: preguide.#Command & { Source: """
echo -n "Hello, world!"
"""}
-- raw/stdout --
package out

{
	Image: "playwithgo/go1.14.6@sha256:b3690d0dc29edfe2d740d3632175da32bc7301b8bec994060c11deaf99c71123"
	Langs: {
		en: {
			Steps: {
				step1: {
					Name:  "step1"
					Order: 0
					Stmts: [{
						Negated:  false
						CmdStr:   "echo -n \"Hello, world!\""
						ExitCode: 0
						Output:   "Hello, world!"
					}]
				}
			}
			Hash: "664f0540ab3d0ca4e99f4cd1d01bf9b8de990f4cc9e0d308628e16a77c4f40a5"
		}
	}
}
