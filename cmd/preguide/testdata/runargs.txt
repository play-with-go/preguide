# Test that -runargs flag works

# Bad args
! preguide gen -out _output -runargs 'term6=-e GREETING=hello'
! stdout .+
stderr 'bad argument passed to -runargs'

# Good args
preguide gen -out _output -runargs 'term1=-e GREETING=hello'
cmp myguide/out/gen_out.cue myguide/out/gen_out.cue.golden

-- myguide/en.markdown --
---
title: A test with all directives
---
# Step 1

<!--step: step1 -->
-- myguide/steps.cue --
package steps

import "github.com/play-with-go/preguide"

Scenarios: go115: preguide.#Scenario & {
	Description: "Go 1.15"
}

Terminals: term1: preguide.#Terminal & {
	Description: "The main terminal"
	Scenarios: go115: Image: "this_will_never_be_used"
}

Steps: step1: preguide.#Command & {Source: """
echo -n "The answer is: $GREETING"
"""}
-- myguide/out/gen_out.cue.golden --
package out

Terminals: [{
	Description: "The main terminal"
	Scenarios: {
		go115: {
			Image: "this_will_never_be_used"
		}
	}
	Name: "term1"
}]
Scenarios: [{
	Description: "Go 1.15"
	Name:        "go115"
}]
Networks: []
Env: []
Steps: {
	step1: {
		Stmts: [{
			Output:   "The answer is: hello"
			ExitCode: 0
			CmdStr:   "echo -n \"The answer is: $GREETING\""
			Negated:  false
		}]
		Order:     0
		DoNotTrim: false
		Terminal:  "term1"
		StepType:  1
		Name:      "step1"
	}
}
Hash: "95aec4e582ce6f9172c4e74915228af4bb57485147114ccfee8d24163d516952"
Delims: ["{{", "}}"]
