# Test that basic outrefs work

preguide gen -out _output
! stdout .+
! stderr .+
cmp _output/myguide.md myguide/en.md.golden

-- myguide/en.md --
---
title: A test with myguide
---
# Hello <!--ref: world-->

Here is a `<!--ref: world-->` code example.

And a fence block:

```
<!--ref: world-->
```

Here are some commands:

<!--step: step1 -->

Here we talk about the second of those commands,
`<!--outref: cmd_false -->`.

-- myguide/guide.cue --
package guide

import "github.com/play-with-go/preguide"

Scenarios: go115: preguide.#Scenario & {
	Description: "Go 1.15"
}

Terminals: term1: preguide.#Guide.#Terminal & {
	Description: "The main terminal"
	Scenarios: go115: Image: "this_will_never_be_used"
}

Defs: world: "world"

Steps: step1: en: preguide.#Command & { Source: """
echo "Hello, world!"
touch blah
! false
ls
"""}
-- myguide/out/myguide.cue --
package out

Langs: _

Defs: {
	cmd_false: Langs.en.Steps.step1.Stmts[2].CmdStr
}
-- myguide/en.md.golden --
---
guide: myguide
lang: en
title: A test with myguide
---
# Hello world

Here is a `world` code example.

And a fence block:

```
world
```

Here are some commands:

```.term1
$ echo "Hello, world!"
Hello, world!
$ touch blah
$ false
$ ls
blah
```
{:data-command-src="ZWNobyAiSGVsbG8sIHdvcmxkISIKdG91Y2ggYmxhaApmYWxzZQpscwo="}

Here we talk about the second of those commands,
`false`.

<script>let pageGuide="myguide"; let pageLanguage="en"; let pageScenario="go115";</script>
